<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="Liyanyan's blog"><title>前端网页资源优化加载 | Liyanyan</title><link rel="stylesheet" type="text/css" href="//fonts.neworld.org/css?family=Source+Code+Pro"><link rel="stylesheet" type="text/css" href="/css/style.css?v=2.0.1"><link rel="stylesheet" type="text/css" href="/css/highlight.css?v=2.0.1"><link rel="Shortcut Icon" href="/favicon.ico"><link rel="bookmark" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><header class="main-header"><div id="main-header-box"><h1 class="hidden">前端网页资源优化加载</h1><a id="logo" href="/.">Liyanyan</a><p class="description"></p></div></header><div class="body_container"><div id="header"><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a></div><div id="search-form"><div id="result-mask" class="hide"></div><label><input id="search-key" type="text" autocomplete="off" placeholder="Arama"></label><div id="result-wrap" class="hide"><div id="search-result"></div></div><div class="hide"><template id="search-tpl"><div class="item"><a href="/{path}" title="{title}"><div class="title">{title}</div><div class="time">{date}</div><div class="tags">{tags}</div></a></div></template></div></div></div><div id="layout" class="layout-g"><div class="layout-l"><div class="content_container"><div class="post"><h1 class="post-title">前端网页资源优化加载</h1><div class="post-meta"><a href="/2019/01/14/前端网页资源优化加载/#comments" class="comment-count"></a><p><span class="date">Jan 14, 2019</span><span><a href="/categories/常用/" class="category">常用</a></span><span><i id="busuanzi_container_page_pv"><i id="busuanzi_value_page_pv"></i><i>点击</i></i></span></p></div><div class="post-content"><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>vue打包的项目,首次加载时间很慢 想要优化一下速度</p>
<h2 id="1-了解资源加载的时序"><a href="#1-了解资源加载的时序" class="headerlink" title="1.了解资源加载的时序"></a>1.了解资源加载的时序</h2><p>根据<a href="https://developers.google.com/web/tools/chrome-devtools/network-performance/understanding-resource-timing#diagnosing-network-issues" target="_blank" rel="noopener">Tools for Web Developers</a><br>Request Timing API生命周期：<br>1.Redircet(重定向)： starTime,redirectTime,redircetEnd<br>2.App Cache(应用程序缓存)：fecthStart<br>3.DNS：domainLookupStart,domainLookupEnd<br>4.TCP： connectStart,secureConnectionStart,connectEnd<br>5.Request：requestStart<br>6.Response: responseStart,responseEnd</p>
<p>在DevTools中查看<br>Queuing: 某个请求正在排队，在HTTP1上，浏览器只允许每个源拥有6个TCP连接<br>Stalled/Blocking: 请求等待发送请求的时间<br>Proxy Negotiation: 与代理服务器协商所用的时间<br>DNS Lookup: 执行DNS查询所需要的时间，每一个新域都需要完整的往返才能执行DNS查询<br>Initial Connection/Connecting: 建立连接所需要的时间，包括TCP握手/重试 和协商SSL的时间<br>SSL: 完成SSL所需要的时间<br>Requeset Sent/Sending: 发出网络请求所需要的时间，通常不到一毫秒<br>Waiting(TTFB): 等待初始相应所用时间，也称为第一字节时间<br>Content DownLoad/DownLoading: 接收响应数据所用的时间</p>
<p>诊断网络问题<br>1.排队或停止阻塞<br>单个客户端检索的资源太多，在HTTP1.0/1.1连接协议中限制每个域名最多执行6个TCP连接，前6个请求后面的需要等待<br>-&gt;实现分域，用多个子域名提供服务资源，将资源拆分到多个子域中，均匀分配<br>HTTP2.0中已经实现了多路复用连接，不需要修改</p>
<p>2.接收到第一个字节时间很慢(绿色很长)<br>客户端和服务器端网络条件差<br>  优化响应速度,优化数据库查询，缓存，修改web服务器配置<br>服务器响应程序很慢</p>
<p>3.加载很慢(蓝色很长)<br>  发送更少字节，压缩图片大小</p>
<h2 id="2-避免无效-多余请求"><a href="#2-避免无效-多余请求" class="headerlink" title="2.避免无效/多余请求"></a>2.避免无效/多余请求</h2><p>如果发生在网页请求开始阶段,会极大影响首屏渲染</p>
<h3 id="2-1避免不必要的重定向"><a href="#2-1避免不必要的重定向" class="headerlink" title="2.1避免不必要的重定向"></a>2.1避免不必要的重定向</h3><p>301,302 303/307重定向比较常见，不必要的重定向浪费时间</p>
<p>trailing slash(末尾斜杠): 是否含斜杠都响应相同内容</p>
<h3 id="2-2尽量避免404"><a href="#2-2尽量避免404" class="headerlink" title="2.2尽量避免404"></a>2.2尽量避免404</h3><p>静态资源返回404浪费宽带,拖延页面渲染时间<br>404浪费一个TCP往返时间 + 其他时间<br>一个浏览器6个TCP并发，404会占用一个，导致其他会有延迟</p>
<p><strong>favicon</strong> 浏览器会请求网址图标,如果不设置404</p>
<link rel="icon" type="image/x-icon" href="https://assets-cdn.github.com/favicon.ico">

<h3 id="2-3正确标签的src"><a href="#2-3正确标签的src" class="headerlink" title="2.3正确标签的src"></a>2.3正确标签的src</h3><h2 id="3-资源及其规则"><a href="#3-资源及其规则" class="headerlink" title="3.资源及其规则"></a>3.资源及其规则</h2><p>主要是指JS/CSS/IMG</p>
<h3 id="3-1资源尽量小-启用压缩"><a href="#3-1资源尽量小-启用压缩" class="headerlink" title="3.1资源尽量小,启用压缩"></a>3.1资源尽量小,启用压缩</h3><p>图片压到合适，不同设备不同分辨率<br>文本内容使用gzip压缩</p>
<h3 id="3-2CDN与域名收敛"><a href="#3-2CDN与域名收敛" class="headerlink" title="3.2CDN与域名收敛"></a>3.2CDN与域名收敛</h3><p>CDN与主站不在同一域名，可以避开浏览器同一域名最大6个TCP连接的限制，提高并发下载能力。</p>
<h3 id="3-3合理设计缓存"><a href="#3-3合理设计缓存" class="headerlink" title="3.3合理设计缓存"></a>3.3合理设计缓存</h3><p>图片，css和js考虑版本迭代</p>
<h3 id="3-4合理的文件合并"><a href="#3-4合理的文件合并" class="headerlink" title="3.4合理的文件合并"></a>3.4合理的文件合并</h3><p>多个文件or图片合并，减少http请求个数</p>
<h3 id="3-5延迟下载"><a href="#3-5延迟下载" class="headerlink" title="3.5延迟下载"></a>3.5延迟下载</h3><p>电商图 首屏不加载，按需加载</p>
</div><div class="tags"></div><div class="post-share"></div><div class="post-nav"><a href="/2019/06/21/2019面试总结/" class="pre">2019面试总结</a><a href="/2018/09/27/前端文件的上传和下载/" class="next">前端文件的上传和下载</a></div><div id="comments"></div></div></div></div><div class="layout-r"><div id="sidebar"><div class="search-pla"></div><div id="toc" class="widget"><div class="widget-title"><i class="fa fa-fei">文章目录</i></div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#前言"><span class="toc-text">前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-了解资源加载的时序"><span class="toc-text">1.了解资源加载的时序</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-避免无效-多余请求"><span class="toc-text">2.避免无效/多余请求</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1避免不必要的重定向"><span class="toc-text">2.1避免不必要的重定向</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2尽量避免404"><span class="toc-text">2.2尽量避免404</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3正确标签的src"><span class="toc-text">2.3正确标签的src</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-资源及其规则"><span class="toc-text">3.资源及其规则</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1资源尽量小-启用压缩"><span class="toc-text">3.1资源尽量小,启用压缩</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2CDN与域名收敛"><span class="toc-text">3.2CDN与域名收敛</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3合理设计缓存"><span class="toc-text">3.3合理设计缓存</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4合理的文件合并"><span class="toc-text">3.4合理的文件合并</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-5延迟下载"><span class="toc-text">3.5延迟下载</span></a></li></ol></li></ol></div><div class="widget"><div class="widget-title"><i class="fa fa-xie"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2019/08/26/一张图理解JS中的原型和原型链/">一张图理解JS中的原型和原型链</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/06/21/2019面试总结/">2019面试总结</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/01/14/前端网页资源优化加载/">前端网页资源优化加载</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/09/27/前端文件的上传和下载/">前端文件的上传和下载</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08/30/Js中Array的各种操作/">Js中Array的各种操作</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08/28/前端面试题汇总/">前端面试题汇总</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08/09/基础小知识笔记/">基础小知识笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08/09/Vue中使用Echarts/">Vue中使用Echarts</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08/09/Vue中使用i18n国际化/">Vue中使用i18n国际化</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/06/28/ElementUI后台管理系统中各种注意事项/">ElementUI后台管理系统中各种注意事项</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-gui"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Echarts/">Echarts</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/JS/">JS</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Vue/">Vue</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/i18n/">i18n</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/前端面试/">前端面试</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/工具/">工具</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/常用/">常用</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/笔记/">笔记</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/编辑器/">编辑器</a><span class="category-list-count">2</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-biao"> 标签</i></div><div class="tagcloud"><a href="/tags/Hexo/" style="font-size: 15px;">Hexo</a> <a href="/tags/MarkDown/" style="font-size: 15px;">MarkDown</a> <a href="/tags/Elint/" style="font-size: 15px;">Elint</a> <a href="/tags/Prettier/" style="font-size: 15px;">Prettier</a> <a href="/tags/Echarts/" style="font-size: 15px;">Echarts</a> <a href="/tags/Vue/" style="font-size: 15px;">Vue</a> <a href="/tags/Vscode/" style="font-size: 15px;">Vscode</a> <a href="/tags/BlueLake主题/" style="font-size: 15px;">BlueLake主题</a> <a href="/tags/Element-ui/" style="font-size: 15px;">Element-ui</a> <a href="/tags/js/" style="font-size: 15px;">js</a> <a href="/tags/JS原型/" style="font-size: 15px;">JS原型</a> <a href="/tags/JS原型链/" style="font-size: 15px;">JS原型链</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-archive"> 归档</i></div><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">八月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">六月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">一月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">九月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">八月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">六月 2018</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-you"> 友情链接</i></div><ul></ul><a href="https://github.com/liyanyan1994" title="github" target="_blank">github</a></div></div></div></div><a id="totop" href="#top"></a><div id="footer"><div class="footer-info"><p><span> Copyright &copy;<a rel="nofollow" target="_blank" href="https://github.com/liyanyan1994"> Liyanyan</a></span></p></div></div></div><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><script type="text/javascript" src="/js/search.json.js?v=2.0.1"></script><script type="text/javascript" src="/js/toctotop.js?v=2.0.1" async></script></body></html>